<Window x:Name="NotesWindow"
        xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:HasteNotes.ViewModels"
        x:Class="HasteNotes.Views.Notes"
        x:DataType="vm:NotesViewModel"
        Width="900" Height="600"
        Title="{Binding Title}">

    <Grid RowDefinitions="Auto,Auto,*,Auto"
          ColumnDefinitions="*,300">

        <!-- Menu -->
        <Menu Grid.Row="0" Grid.ColumnSpan="2">
            <MenuItem Header="_File">
                <MenuItem Header="_New"  Command="{Binding NewCommand}"/>
                <MenuItem Header="_Open" Command="{Binding OpenCommand}" />
                <MenuItem Header="_Save" Command="{Binding SaveCommand}"/>
                <Separator/>
                <MenuItem Header="E_xit" Command="{Binding ExitCommand}"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <Grid Grid.Row="1" Grid.ColumnSpan="4"
              Margin="12,8"
              ColumnDefinitions="Auto,8,Auto,8,Auto">
            <Button Content="Add" Command="{Binding AddCommand}"/>
            <Rectangle Grid.Column="1" Width="8"/>
            <Button Grid.Column="2" Content="Edit" Command="{Binding EditCommand}"/>
            <Rectangle Grid.Column="3" Width="8"/>
            <Button Grid.Column="4" Content="Delete" Command="{Binding DeleteNoteCommand}"/>
        </Grid>

        <!-- NOTES AREA -->
        <Grid Grid.Row="2" Grid.Column="0" Margin="12"
              RowDefinitions="Auto,Auto,*">

            <!-- Note title -->
            <TextBlock Grid.Row="0"
                       Text="{Binding SelectedNote.Title}"
                       FontSize="18"
                       FontWeight="Bold"
                       IsVisible="{Binding SelectedNote, Converter={x:Static ObjectConverters.IsNotNull}}"/>

            <!-- Boss Info -->
            <StackPanel Grid.Row="1"
                        IsVisible="{Binding IsBossNoteVisible}"
                        Margin="0,8"
                        Spacing="8">

                <TextBlock Text="{Binding SelectedNote.SelectedBoss.BossName}"
                           FontWeight="Bold"/>

                <!-- Headers -->
                <Grid ColumnDefinitions="*,*,*" Margin="0,0,0,8">
                    <TextBlock Text="HP" FontWeight="Bold"/>
                    <TextBlock Text="Steals" Grid.Column="1" FontWeight="Bold"/>
                    <TextBlock Text="Items" Grid.Column="2" FontWeight="Bold"/>
                </Grid>

                <!-- Data -->
                <Grid ColumnDefinitions="*,*,*">
                    <TextBlock Text="{Binding SelectedNote.SelectedBoss.Hp}"/>

                    <ItemsControl Grid.Column="1"
                                  ItemsSource="{Binding SelectedNote.SelectedBoss.VisibleSteals}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Display}"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <ItemsControl Grid.Column="2"
                                  ItemsSource="{Binding SelectedNote.SelectedBoss.VisibleItems}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Display}"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                </Grid>
            </StackPanel>

            <!-- Scrollable note content -->
            <Border Grid.Row="2"
                    BorderBrush="#DDD"
                    BorderThickness="1"
                    CornerRadius="4">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <TextBlock Text="{Binding SelectedNote.Content}"
                               Padding="10"
                               TextWrapping="Wrap"/>
                </ScrollViewer>
            </Border>

        </Grid>

        <!-- CHECKLIST SIDEBAR -->
       <Border Grid.Row="2" Grid.Column="1"
        Margin="8,12,12,12"
        BorderBrush="#DDD"
        BorderThickness="1"
        CornerRadius="4"
        Padding="12">

    <Grid RowDefinitions="Auto,Auto,*">

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Checklist" FontWeight="Bold" Margin="0,0,0,8"/>

        <!-- Input for new checklist item -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="4" Margin="0,0,0,8">
            <TextBox Width="200"
                     Watermark="New item"
                     Text="{Binding NewChecklistText, UpdateSourceTrigger=PropertyChanged}"/>
            <Button Content="Add"
                    Command="{Binding AddChecklistCommand}"/>
        </StackPanel>

        <!-- Scrollable checklist -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Checklist}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,2" ColumnDefinitions="*,Auto">
                            <!-- Checkbox -->
                            <CheckBox Grid.Column="0"
                                      IsChecked="{Binding IsChecked}"
                                      Content="{Binding Text}"
                                      VerticalAlignment="Center"/>

                            <!-- Remove button, floated right -->
                            <Button Grid.Column="1"
                                    Content="&#x2715;"
                                    Command="{Binding DataContext.RemoveChecklistCommand, ElementName=NotesWindow}"
                                    CommandParameter="{Binding}"
                                    Width="24"
                                    Height="24"
                                    Padding="0"
                                    Margin="4,0,0,0"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    BorderBrush="Transparent"/>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

    </Grid>
</Border>


        <!-- Navigation -->
        <Grid Grid.Row="3" Grid.ColumnSpan="2"
              Margin="12,0,12,12"
              ColumnDefinitions="*,Auto,8,Auto,*">

            <Button Grid.Column="1"
                    Content="Prev"
                    Width="120"
                    Command="{Binding PrevCommand}"/>

            <Button Grid.Column="3"
                    Content="Next"
                    Width="120"
                    Command="{Binding NextCommand}"/>

        </Grid>

    </Grid>
</Window>
